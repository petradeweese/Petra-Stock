{% extends 'base.html' %}
{% block title %}Pattern Finder â€” Favorites{% endblock %}
{% block content %}
  <div class="card">
    <h1 style="margin-top:0;">Favorites</h1>
    {% if favorites and favorites|length %}
    <div class="actions">
      <form method="post" action="/favorites/delete-duplicates" style="margin:0;">
        <button type="submit">Remove Duplicates</button>
      </form>
    </div>
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Ticker</th>
          <th>Direction</th>
          <th>Interval</th>
          <th>ROI%</th>
          <th>Hit%</th>
          <th>DD%</th>
          <th>Rule</th>
          <th>Alerts</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for f in favorites %}
        <tr>
          <td>{{ f["id"] }}</td>
          <td><strong>{{ f["ticker"] }}</strong></td>
          <td>{{ f["direction"] }}</td>
          <td>{{ f["interval"] }}</td>
          <td>{{ '{:.0f}'.format(f['avg_roi_pct']*100 if f['avg_roi_pct'] is not none and f['avg_roi_pct'] <= 1 else f['avg_roi_pct']) if f['avg_roi_pct'] is not none else '' }}</td>
          <td>{{ '{:.1f}'.format(f['hit_pct']) if f['hit_pct'] is not none else '' }}</td>
          <td>{{ '{:.0f}'.format(f['avg_dd_pct']*100 if f['avg_dd_pct'] is not none and f['avg_dd_pct'] <= 1 else f['avg_dd_pct']) if f['avg_dd_pct'] is not none else '' }}</td>
          <td><code>{{ f["rule"] }}</code></td>
          <td>
            <form method="post" action="/favorites/update/{{ f['id'] }}" style="margin:0; display:flex; gap:4px; align-items:center;">
              <input type="checkbox" name="alerts_enabled" value="1" {% if f['alerts_enabled'] %}checked{% endif %} />
              <input name="cooldown_minutes" type="number" value="{{ f['cooldown_minutes'] or st['fav_cooldown_minutes'] }}" style="width:60px;" />
              <button type="submit">Save</button>
            </form>
          </td>
          <td>
            <form method="post" action="/favorites/delete/{{ f['id'] }}" style="margin:0;">
              <button type="submit" class="del-btn">&#10005;</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>No favorites yet. Right-click a row in Results to add one.</p>
    {% endif %}
  </div>
{% endblock %}
